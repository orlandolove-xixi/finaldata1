# Excel数据处理工具

一个用于自动整理Excel数据的Web应用，特别是针对包含多个重复表格结构的Excel文件。

## 功能特点

- **自动提取指标名称**：从Excel第一列提取所有唯一的指标名称作为处理后表格的行索引
- **智能识别县域名称**：自动识别Excel中的县域名称（包含"县"、"市"、"区"等特征）作为列索引
- **保持数据对应关系**：确保处理后的数据与原始数据一一对应
- **支持复杂表格结构**：可以处理包含多个重复表格的Excel文件
- **用户友好界面**：提供直观的Web界面，支持拖放上传和文件下载

## 技术栈

- **后端**：Python + Flask
- **数据处理**：Pandas + Openpyxl
- **前端**：HTML + Tailwind CSS + Font Awesome

## 使用方法

### 快速开始

1. 双击运行 `start.bat` 脚本
2. 脚本会自动创建虚拟环境、安装依赖并启动Web服务
3. 打开浏览器，访问 `http://localhost:5000`
4. 上传您的Excel文件，系统会自动处理并返回结果

### 手动安装

如果需要手动安装依赖，可以执行以下命令：

```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
venv\Scripts\activate  # Windows
# 或者 source venv/bin/activate  # Linux/Mac

# 安装依赖
pip install -r requirements.txt

# 启动应用
python main.py
```

## 数据处理规则

1. **指标名称提取**：系统会自动从Excel文件的第一列提取所有唯一的文本作为指标名称
2. **县域名称识别**：系统使用以下策略识别县域名称：
   - 优先识别包含"县"、"市"、"区"等特征的文本
   - 寻找"单位"行后面的列标题
   - 如果上述方法失败，会使用其他列名作为备选
3. **数据填充**：系统会根据指标行和数据行的对应关系，将数据正确填充到处理后的表格中

## 注意事项

- 目前支持的Excel格式：`.xlsx` 和 `.xls`
- 对于复杂的表格结构，系统会尝试多种策略进行解析
- 处理后的文件会自动下载到您的电脑

## 项目结构

```
data2/
├── main.py              # 主程序文件
├── requirements.txt     # 项目依赖
├── start.bat            # 启动脚本
└── templates/           # HTML模板目录
    └── index.html       # 主页面模板
```

## 故障排除

如果遇到问题，可以尝试以下方法：

1. 确保您的Python版本为3.7或更高
2. 检查Excel文件格式是否正确
3. 查看命令行输出的错误信息
4. 尝试重新运行 `start.bat` 脚本

## 许可证

MIT License